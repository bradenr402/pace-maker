<div class="card">
  <%= link_to user, data: { turbo: false }, class: 'group flex items-start gap-4 flex-1' do %>

    <% if user.avatar.attached? %>
      <%= image_tag user.avatar.variant(resize_to_limit: [100, 100]).processed, class: 'shrink-0 size-12 rounded-lg drop-shadow-lg dark:drop-shadow-none object-cover' %>
    <% else %>
      <div class="size-12 bg-slate-200 dark:bg-slate-700 rounded-lg drop-shadow-lg dark:drop-shadow-none grid place-items-center">
        <%= inline_svg_tag 'icons/user.svg', class: 'size-8 text-soft' %>
      </div>
    <% end %>

    <div class="flex-1">
      <p class='text-lg font-bold transition duration-300 ease-in-out group-hover:text-indigo-600 dark:group-hover:text-indigo-500'>
        <%= user.default_name %>
        <%= content_tag(:span, '(You)', class: 'text-soft text-xs') if user == current_user %>
      </p>

      <%= content_tag(:p, user.username, class: 'text-soft text-sm') if user.display_name.present? %>
    </div>
  <% end %>

  <% coach_check = user != current_user && user.any_owned_teams_in_common?(current_user) %>
  <% member_check = user != current_user && user.any_membered_teams_in_common?(current_user) %>

  <% if coach_check || member_check %>
    <div class="mt-4 space-y-2 border-t pt-4 dark:border-slate-700">
      <% if coach_check %>
        <div class="flex items-start gap-1.5">
          <%= inline_svg_tag 'icons/user.svg', class: 'size-4 text-soft shrink-0' %>
          <p class="text-soft text-xs">Coach of: <%= list(items: user.owned_teams_in_common(current_user).map { |team| link_to(team.name, team, data: { turbo: false }, class: 'btn-link') }).html_safe %></p>
        </div>
      <% end %>

      <% if member_check %>
        <div class="flex items-start gap-1.5">
          <%= inline_svg_tag 'icons/team.svg', class: 'size-4 text-soft shrink-0' %>
          <p class="text-soft text-xs">Member of: <%= list(items: user.membered_teams_in_common(current_user).map { |team| link_to(team.name, team, data: { turbo: false }, class: 'btn-link') }).html_safe %></p>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
