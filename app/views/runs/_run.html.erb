<div class="my-6">
  <article id="<%= dom_id run %>">
    <div class="card text-normal">
      <% unless current_page?(run_path(run)) || current_page?(user_path(run.user)) || !local_assigns[:team] %>
        <div class="mb-4 flex flex-wrap-reverse items-center gap-4">
          <% unless current_page?(run_path(run)) || current_page?(user_path(run.user)) %>
            <% path = local_assigns[:team] ? team_member_path(team, run.user) : user_path(run.user) %>

            <%= link_to path, data: { turbo: false }, class: 'group mr-auto flex items-center gap-2 flex-grow' do %>
              <%= render 'shared/user_photo', user: run.user, size: :sm %>
              <p class="text-lg font-bold transition duration-300 ease-in-out group-hover:text-indigo-600 dark:group-hover:text-indigo-500"><%= run.user.default_name %></p>
            <% end %>
          <% end %>

          <% if local_assigns[:team] %>
            <% streak_data = run.user.current_streak(team) %>
            <% streak = streak_data[:streak] %>
            <% streak_end_date = streak_data[:end_date] %>

            <div class="flex flex-wrap items-center gap-2">
              <%= render 'runs/long_run_badge' if local_assigns[:team] && run.long_run_for?(team) %>
              <% if local_assigns[:team] && streak.positive? %>
                <% if (run.date.today? && streak_end_date&.today?) || (run.date.yesterday? && streak_end_date&.yesterday?) %>
                  <%= render 'runs/streak_badge', streak: streak %>
                <% elsif run.date.yesterday? && streak_end_date&.today? %>
                  <%= render 'runs/streak_badge', streak: streak - 1 %>
                <% end %>
              <% end %>
            </div>
          <% end %>
        </div>
      <% end %>

      <% if current_page?(run) || local_assigns[:turbo_frame] %>
        <%= render 'runs/run_content', run: run, team: local_assigns[:team] %>
      <% else %>
        <%= link_to run, data: { turbo: false }, class: 'block' do %>
          <%= render 'runs/run_content', run: run, team: local_assigns[:team] %>
        <% end %>
      <% end %>
    </div>
  </article>
</div>
