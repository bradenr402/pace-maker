<% content_for :title, "#{@team.name} Topics" %>

<div
  data-controller="modal"
  data-modal-hide-modal-class="opacity-0 scale-75 pointer-events-none"
  data-modal-show-modal-class="opacity-100 scale-100 pointer-events-auto"
  data-modal-hide-backdrop-class="opacity-0 pointer-events-none"
  data-modal-show-backdrop-class="opacity-100 pointer-events-auto"
  class="max-w-3xl mx-auto my-16"
>
  <%= link_to @team, class: 'group flex items-center gap-3 z-40 py-4 border-b border-slate-200 dark:border-slate-700 sticky top-0 bg-slate-50 dark:bg-slate-900', aria: { label: "Back to #{@team.name}" } do %>
    <%= inline_svg_tag 'icons/chevron-left-bold.svg', class: 'size-6 transition ease-in-out duration-200 group-hover:text-indigo-600 dark:group-hover:text-indigo-500' %>
    <div class="flex items-center justify-start gap-4">
      <%= render 'shared/team_photo', team: @team, size: :xs, icon_background: :darker %>
      <p class="text-lg font-bold transition ease-in-out duration-200 group-hover:text-indigo-600 dark:group-hover:text-indigo-500"><%= @team.name %></p>
    </div>
  <% end %>

  <div class="mb-24">
    <%= render 'main_chat_topic', team: @team %>

    <h2 class="text-lg font-semibold mb-3">Topics</h2>
    <% if @topics.present? %>
      <div>
        <% @topics.each do |topic| %>
          <%= render topic %>
        <% end %>
      </div>

      <div class="flex justify-center mt-12">
        <button data-action="mousedown->modal#open" data-modal-id="newTopicModal" class="btn btn-sm btn-primary btn-muted">New topic</button>
      </div>
    <% else %>
      <div class="flex flex-col items-center justify-center gap-6 mt-12">
        <p class="text-soft text-center">There are no open topics.</p>
        <button data-action="mousedown->modal#open" data-modal-id="newTopicModal" class="btn btn-primary">New topic</button>
      </div>
    <% end %>
  </div>

  <% if @closed_topics.present? %>
    <div class="mb-24">
      <div class="pb-6 my-6 border-b border-slate-200 dark:border-slate-700">
        <h2 class="subheading">Closed Topics</h2>
        <p class="text-sm text-soft">Topics that have been closed to new messages.</p>
      </div>

      <div>
        <% @closed_topics.each do |topic| %>
          <%= render topic %>
        <% end %>
      </div>
    </div>
  <% end %>

  <%= render 'topics/new_topic_modal' %>
</div>
